#!/usr/bin/env ruby
require "theysaidsocli"

quote_fetcher = Theysaidsocli::QuoteFetcher.new

entered_ARGV = ARGV.length > 0;

def print_quote(qod)
    print_text = "#{qod.author} said: #{qod.quote}"

    puts "*" * (print_text.size + 4)
    puts "| #{print_text} |"
    puts "*" * (print_text.size + 4)
end

begin
    unless entered_ARGV
        qod = quote_fetcher.qod
        print_quote(qod)
        return
    end

    case ARGV[0]

        when "-h"
            puts "Hello! Welcome to the help menu of the TheySaySo cli."
            puts "             | Get the quote of the day"
            puts "  -cat       | Get quote categories"
            puts "  -cat <Cat> | Pick a quote from a specific category"
            exit
        when "-cat"

            if ARGV[1]
                qod = quote_fetcher.qod(ARGV[1])
                print_quote(qod)
                return
            end

            categories = quote_fetcher.categories
            puts "Available categories:"
            categories.each { |c| puts c.to_s }
        else
            puts "Unknown option. Use theysaidsocli -h for help."
        end

rescue Theysaidsocli::RateLimitError
    puts "You are making too many requests... Try again in an hour."
rescue Theysaidsocli::NotFoundError
    puts "No results were found with the term used. Try again with a different term.."
end


