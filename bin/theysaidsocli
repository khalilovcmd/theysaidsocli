#!/usr/bin/env ruby
require "theysaidsocli"

ct = Theysaidsocli::QuoteFetcher.new

entered_ARGV = ARGV.length > 0;

def print_quote(qod)
    print_text = "#{qod.author} said: #{qod.quote}"

    puts "*" * (print_text.size + 4)
    puts "| #{print_text} |"
    puts "*" * (print_text.size + 4)
end

begin
    unless entered_ARGV
        qod = ct.qod
        print_quote(qod)
        return
    end

    case ARGV[0]

        when "-h"
            puts "Hello! Welcome to the help menu of the TheySaySo cli."
            puts "             | Get the quote of the day"
            puts "  -cat       | Get quote categories"
            puts "  -cat <Cat> | Pick a quote from a specific category"
            exit
        when "-cat"

            if ARGV[1]
                qod = ct.qod(ARGV[1])
                print_quote(qod)
                return
            end

            categories = ct.categories
            puts "Available categories:"

            categories.each do |key, value|
                puts "#{key}: '#{value}'"
        end
    end

rescue Theysaidsocli::RateLimitError
    puts "You are making too many requests... Try again in an hour."
rescue Theysaidsocli::NotFoundError
    puts "No results were found with the terms used. Try again with a different term.."
end


